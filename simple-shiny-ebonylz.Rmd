---
title: "simple-shiny-ebonylz"
author: "ebonylz"
date: "2025-03-04"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, stringr)
```

## Introduction

This R Markdown document is made interactive using Shiny to demonstrate my abilities to make interactive data visualizations.

```{r load data, include=FALSE}
title <- read_tsv('title.basics.tsv')
ratings <- read_tsv('title.ratings.tsv')

film <- title %>%
  merge(ratings) %>%
  filter(numVotes > 100) %>%
  mutate(startYear = as.Date(as.character(startYear), format = "%Y"),
         endYear= as.Date(as.character(endYear), format = "%Y"))
rm(ratings, title)
gc()

```

## IMDb data{.tabset}

### Top movies by year

The plot below shows time series of movies with an average rating higher than an 8 by more than 1,000 raters.

```{r type, echo=FALSE}
inputPanel(
  selectInput("filmtype", label = "Type of film:",
              choices = unique(film$titleType), 
              selected = "movie", 
              multiple = TRUE),
  sliderInput("daterange", 
              label = "Date range:",
              min = 1890, 
              max = 2025,
              value = 
                c(2019, 2025),
          sep = "")
)

renderPlot({
  film %>% 
    filter(titleType %in% input$filmtype, averageRating >=8, numVotes >=1000) %>%
    ggplot(aes(x = startYear, y = averageRating, size = numVotes, color = titleType)) +
    geom_point()+
      labs(x = NULL, y = NULL,
         title = "Ratings with an 8 or higher",
         caption = "Source: IMDb") + 
      theme_minimal()
})
```
